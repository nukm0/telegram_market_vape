<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vape Market | –ë–∞—Ä–∞—Ö–æ–ª–∫–∞ –¥–ª—è –≤–µ–π–ø–æ–≤</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* –§–∏–æ–ª–µ—Ç–æ–≤—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –¥–ª—è —Ñ–æ–Ω–∞ */
        :root {
            --gradient-primary: linear-gradient(135deg, #8B5CF6 0%, #7C3AED 50%, #6D28D9 100%);
            --gradient-secondary: linear-gradient(135deg, #A78BFA 0%, #8B5CF6 50%, #7C3AED 100%);
            --gradient-dark: linear-gradient(135deg, #6D28D9 0%, #5B21B6 50%, #4C1D95 100%);
            
            --button-primary: #7C3AED;
            --button-hover: #6D28D9;
            --button-active: #5B21B6;
            --button-success: #10B981;
            --button-error: #EF4444;
            --button-info: #3B82F6;
            --button-warning: #F59E0B;
            
            --text-light: #FFFFFF;
            --text-dark: #1F2937;
            --text-muted: #9CA3AF;
            
            --shadow: 0 10px 25px -5px rgba(139, 92, 246, 0.3);
            --shadow-dark: 0 10px 25px -5px rgba(0, 0, 0, 0.4);
            
            --card-bg: rgba(255, 255, 255, 0.95);
            --card-bg-dark: rgba(30, 27, 75, 0.95);
        }
        
        /* –°–±—Ä–æ—Å —Å—Ç–∏–ª–µ–π */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        html, body {
            height: 100%;
            overflow: hidden;
        }
        
        body {
            background: var(--gradient-primary);
            color: var(--text-light);
            transition: background 0.5s ease;
        }
        
        /* –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞ */
        .browser-error {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-dark);
            z-index: 9999;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .browser-error i {
            font-size: 64px;
            color: #EF4444;
            margin-bottom: 20px;
        }
        
        .browser-error h2 {
            font-size: 24px;
            margin-bottom: 15px;
            color: white;
        }
        
        .browser-error p {
            color: #D8B4FE;
            margin-bottom: 10px;
            max-width: 400px;
        }
        
        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è */
        .app-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 10px;
            max-width: 500px;
            margin: 0 auto;
        }
        
        /* –®–∞–ø–∫–∞ */
        .app-header {
            padding: 15px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            margin-bottom: 15px;
            box-shadow: var(--shadow);
            position: relative;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
        }
        
        .logo i {
            font-size: 24px;
            color: #A78BFA;
        }
        
        .logo span {
            font-size: 20px;
            font-weight: 700;
            background: linear-gradient(90deg, #FFFFFF, #E9D5FF);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        /* –ö–æ–Ω—Ç–µ–Ω—Ç */
        .main-content {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(5px);
            margin-bottom: 10px;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è - –í–ú–ï–°–¢–ï –° –§–û–†–ú–û–ô –°–í–ï–†–•–£ */
        .add-ad-section {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .add-ad-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .add-ad-title {
            font-size: 18px;
            font-weight: 600;
        }
        
        .toggle-form-btn {
            padding: 10px 20px;
            border-radius: 12px;
            background: linear-gradient(135deg, #8B5CF6 0%, #7C3AED 100%);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .toggle-form-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%);
            border-radius: 10px;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .toggle-form-btn:hover::before {
            opacity: 1;
        }
        
        .toggle-form-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.4);
        }
        
        /* –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è */
        .add-ad-form {
            display: none;
            margin-top: 20px;
        }
        
        .add-ad-form.active {
            display: block;
        }
        
        /* –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ */
        .categories {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 10px 0;
            margin-bottom: 20px;
            scrollbar-width: none;
        }
        
        .categories::-webkit-scrollbar {
            display: none;
        }
        
        .category-btn {
            padding: 10px 20px;
            border-radius: 25px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-weight: 600;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .category-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%);
            border-radius: 23px;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .category-btn:hover::before {
            opacity: 1;
        }
        
        .category-btn:hover {
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }
        
        .category-btn.active {
            background: linear-gradient(135deg, #8B5CF6 0%, #7C3AED 100%);
            border-color: rgba(255, 255, 255, 0.5);
            color: white;
        }
        
        /* –û–±—ä—è–≤–ª–µ–Ω–∏–µ (—Ç–æ–≤–∞—Ä + –ø—Ä–æ–¥–∞–≤–µ—Ü –≤–º–µ—Å—Ç–µ) */
        .advertisement-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }
        
        .advertisement-card:hover {
            transform: translateY(-2px);
        }
        
        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–æ–¥–∞–≤—Ü–∞ */
        .seller-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .seller-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
        }
        
        .seller-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .seller-info {
            flex: 1;
        }
        
        .seller-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 3px;
        }
        
        .seller-username {
            font-size: 14px;
            color: #D8B4FE;
            margin-bottom: 5px;
        }
        
        .seller-stats {
            display: flex;
            gap: 15px;
            font-size: 12px;
        }
        
        .seller-stat {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .seller-stat i {
            font-size: 14px;
        }
        
        .stat-likes i { color: #10B981; }
        .stat-dislikes i { color: #EF4444; }
        .stat-rating i { color: #F59E0B; }
        
        /* –ì–∞–ª–µ—Ä–µ—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Ç–æ–≤–∞—Ä–∞ */
        .photo-gallery {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding: 10px 0;
            min-height: 130px;
        }
        
        .photo-item {
            width: 120px;
            height: 120px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.2);
            position: relative;
            cursor: pointer;
        }
        
        .photo-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #A78BFA;
            font-size: 12px;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .photo-placeholder i {
            font-size: 36px;
            margin-bottom: 10px;
        }
        
        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .photo-label {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            z-index: 2;
        }
        
        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–µ */
        .product-info {
            margin-bottom: 15px;
        }
        
        .product-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 10px;
            color: white;
        }
        
        .product-category {
            display: inline-block;
            padding: 5px 12px;
            background: rgba(124, 58, 237, 0.4);
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 15px;
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .product-price {
            font-size: 24px;
            font-weight: 800;
            color: #10B981;
            margin-bottom: 15px;
        }
        
        .product-description {
            font-size: 14px;
            color: #D8B4FE;
            line-height: 1.5;
            margin-bottom: 15px;
        }
        
        /* –ö—Ä—É–≥–ª—ã–µ –∫–Ω–æ–ø–∫–∏ –ª–∞–π–∫–∞/–¥–∏–∑–ª–∞–π–∫–∞ */
        .action-grid {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
            margin-top: 10px;
        }
        
        .rate-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 24px;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
        }
        
        .rate-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%);
            border-radius: 50%;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .rate-btn:hover::before {
            opacity: 1;
        }
        
        .rate-btn:hover {
            transform: scale(1.1);
        }
        
        .rate-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }
        
        .like-btn {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.3) 0%, rgba(16, 185, 129, 0.2) 100%);
            color: #10B981;
            border: 2px solid rgba(16, 185, 129, 0.5);
        }
        
        .like-btn:hover {
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.4);
        }
        
        .like-btn.active {
            background: linear-gradient(135deg, #10B981 0%, #0DA674 100%);
            color: white;
            border-color: #10B981;
        }
        
        .dislike-btn {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.3) 0%, rgba(239, 68, 68, 0.2) 100%);
            color: #EF4444;
            border: 2px solid rgba(239, 68, 68, 0.5);
        }
        
        .dislike-btn:hover {
            box-shadow: 0 0 15px rgba(239, 68, 68, 0.4);
        }
        
        .dislike-btn.active {
            background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
            color: white;
            border-color: #EF4444;
        }
        
        .contact-btn {
            flex: 2;
            padding: 16px;
            border-radius: 15px;
            background: linear-gradient(135deg, #8B5CF6 0%, #7C3AED 100%);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .contact-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%);
            border-radius: 13px;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .contact-btn:hover::before {
            opacity: 1;
        }
        
        .contact-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.4);
        }
        
        /* –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è */
        .form-input {
            width: 100%;
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(0, 0, 0, 0.3);
            color: white;
            font-size: 14px;
            margin-bottom: 15px;
        }
        
        .form-input::placeholder {
            color: #A78BFA;
        }
        
        select.form-input {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='white' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 12px;
            padding-right: 40px;
        }
        
        /* –§–æ—Ç–æ –∑–∞–≥—Ä—É–∑–∫–∞ */
        .photo-upload-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px dashed rgba(255, 255, 255, 0.2);
        }
        
        .upload-btn {
            width: 100%;
            padding: 15px;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.4) 0%, rgba(124, 58, 237, 0.3) 100%);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .upload-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%);
            border-radius: 10px;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .upload-btn:hover::before {
            opacity: 1;
        }
        
        .upload-btn:hover {
            transform: translateY(-2px);
        }
        
        .upload-info {
            font-size: 12px;
            color: #D8B4FE;
            text-align: center;
            margin-top: 10px;
        }
        
        /* –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
        .bottom-nav {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 10px;
            margin-top: 5px;
            box-shadow: var(--shadow);
        }
        
        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px 5px;
            border-radius: 12px;
            background: transparent;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }
        
        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            border-radius: 10px;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .nav-item:hover::before {
            opacity: 1;
        }
        
        .nav-item.active {
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.3) 0%, rgba(124, 58, 237, 0.2) 100%);
        }
        
        .nav-item:hover {
            transform: translateY(-2px);
        }
        
        .nav-icon {
            font-size: 20px;
            margin-bottom: 5px;
            position: relative;
            z-index: 2;
        }
        
        .nav-label {
            font-size: 11px;
            font-weight: 600;
            position: relative;
            z-index: 2;
        }
        
        /* –°—Ç—Ä–∞–Ω–∏—Ü—ã */
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
        }
        
        /* –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç */
        .profile-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .profile-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .profile-avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: var(--gradient-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
        }
        
        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .profile-info h2 {
            font-size: 20px;
            margin-bottom: 5px;
        }
        
        .profile-info p {
            font-size: 14px;
            color: #D8B4FE;
        }
        
        .profile-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .profile-stat {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stat-number {
            display: block;
            font-size: 24px;
            font-weight: 700;
            color: #A78BFA;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 12px;
            color: #9CA3AF;
        }
        
        /* –í–∫–ª–∞–¥–∫–∏ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ */
        .profile-tabs {
            display: flex;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 5px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .profile-tab {
            flex: 1;
            text-align: center;
            padding: 10px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 14px;
        }
        
        .profile-tab.active {
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.4) 0%, rgba(124, 58, 237, 0.3) 100%);
        }
        
        .profile-tab-content {
            display: none;
        }
        
        .profile-tab-content.active {
            display: block;
        }
        
        /* –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ */
        .history-list {
            margin-top: 20px;
        }
        
        .history-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .history-info h4 {
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .history-info p {
            font-size: 12px;
            color: #D8B4FE;
        }
        
        .remove-history-btn {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.3) 0%, rgba(239, 68, 68, 0.2) 100%);
            border: 1px solid rgba(239, 68, 68, 0.5);
            color: #EF4444;
            padding: 5px 10px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
        }
        
        /* –ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è */
        .my-ads-list {
            margin-top: 20px;
        }
        
        .my-ad-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .my-ad-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }
        
        .my-ad-title {
            font-size: 16px;
            font-weight: 600;
            color: white;
        }
        
        .my-ad-price {
            font-size: 18px;
            font-weight: 700;
            color: #10B981;
        }
        
        .my-ad-description {
            font-size: 14px;
            color: #D8B4FE;
            margin-bottom: 10px;
        }
        
        .my-ad-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .edit-ad-btn, .delete-ad-btn {
            flex: 1;
            padding: 8px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            transition: all 0.3s ease;
        }
        
        .edit-ad-btn {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.4) 0%, rgba(59, 130, 246, 0.3) 100%);
        }
        
        .delete-ad-btn {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.4) 0%, rgba(239, 68, 68, 0.3) 100%);
        }
        
        /* FAQ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ */
        .faq-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .faq-item {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .faq-item:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateY(-2px);
        }
        
        .faq-question {
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 15px;
        }
        
        .faq-answer {
            margin-top: 10px;
            color: #D8B4FE;
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ –∂–∞–ª–æ–±—ã */
        .complaint-btn {
            width: 100%;
            padding: 15px;
            border-radius: 15px;
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.3) 0%, rgba(239, 68, 68, 0.2) 100%);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: #EF4444;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .complaint-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%);
            border-radius: 13px;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .complaint-btn:hover::before {
            opacity: 1;
        }
        
        .complaint-btn:hover {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.4) 0%, rgba(239, 68, 68, 0.3) 100%);
            transform: translateY(-2px);
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ñ–æ—Ç–æ */
        .photo-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        
        .photo-modal.active {
            display: flex;
        }
        
        .photo-modal-img {
            max-width: 90%;
            max-height: 70%;
            object-fit: contain;
            border-radius: 10px;
        }
        
        .photo-modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.1) 100%);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .photo-modal-close:hover {
            transform: scale(1.1);
        }
        
        .photo-modal-counter {
            color: white;
            margin-top: 20px;
            font-size: 18px;
        }
        
        .photo-modal-nav {
            position: absolute;
            top: 50%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
            transform: translateY(-50%);
        }
        
        .photo-modal-nav-btn {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.1) 100%);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .photo-modal-nav-btn:hover {
            transform: scale(1.1);
        }
        
        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
            z-index: 1000;
            transition: transform 0.5s ease;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            max-width: 90%;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .notification.show {
            transform: translateX(-50%) translateY(0);
        }
        
        .notification.success {
            border-left: 4px solid #10B981;
        }
        
        .notification.error {
            border-left: 4px solid #EF4444;
        }
        
        .notification.info {
            border-left: 4px solid #3B82F6;
        }
        
        .notification.warning {
            border-left: 4px solid #F59E0B;
        }
        
        /* –°–∫—Ä–æ–ª–ª–±–∞—Ä */
        ::-webkit-scrollbar {
            width: 5px;
            height: 5px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #8B5CF6;
            border-radius: 10px;
        }
        
        /* –°–∫—Ä—ã—Ç—ã–π input –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ */
        .hidden-file-input {
            display: none;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ —Ñ–æ—Ä–º—ã */
        .form-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .publish-btn {
            flex: 2;
            padding: 15px;
            border-radius: 12px;
            background: linear-gradient(135deg, #8B5CF6 0%, #7C3AED 100%);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .publish-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%);
            border-radius: 10px;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .publish-btn:hover::before {
            opacity: 1;
        }
        
        .publish-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.4);
        }
        
        .cancel-btn {
            flex: 1;
            padding: 15px;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.3) 0%, rgba(239, 68, 68, 0.2) 100%);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .cancel-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%);
            border-radius: 10px;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .cancel-btn:hover::before {
            opacity: 1;
        }
        
        .cancel-btn:hover {
            transform: translateY(-2px);
        }
        
        /* –°—Ç–∏–ª—å –¥–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫ –ª–∞–π–∫–∞/–¥–∏–∑–ª–∞–π–∫–∞ */
        .rate-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .rate-btn:disabled:hover {
            transform: none;
        }
        
        .rate-btn:disabled::before {
            display: none;
        }
        
        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ FAQ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }
        
        .stat-box {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stat-box .stat-number {
            font-size: 24px;
            font-weight: 700;
            color: #A78BFA;
            margin-bottom: 5px;
        }
        
        .stat-box .stat-label {
            font-size: 12px;
            color: #D8B4FE;
        }
        
        .admin-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .admin-btn {
            flex: 1;
            padding: 10px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
            font-size: 12px;
        }
        
        .admin-btn.blue {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.4) 0%, rgba(59, 130, 246, 0.3) 100%);
        }
        
        .admin-btn.red {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.4) 0%, rgba(239, 68, 68, 0.3) 100%);
        }
    </style>
</head>
<body>
    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞ -->
    <div class="browser-error" id="browserError">
        <i class="fas fa-exclamation-triangle"></i>
        <h2>–¢–æ–ª—å–∫–æ –≤ Telegram!</h2>
        <p>–≠—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ Telegram Web App.</p>
        <p>–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞.</p>
        <p style="margin-top: 20px; font-size: 12px; color: rgba(255,255,255,0.5);">
            –î–ª—è –¥–æ—Å—Ç—É–ø–∞ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º: @nukm0
        </p>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div class="app-container" id="appContainer" style="display: none;">
        <!-- –®–∞–ø–∫–∞ -->
        <header class="app-header">
            <div class="logo">
                <i class="fas fa-smoking"></i>
                <span id="header-title">Vape Market</span>
            </div>
        </header>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main class="main-content" id="main-content">
            <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 1: –û–±—ä—è–≤–ª–µ–Ω–∏—è -->
            <div class="page active" id="page-ads">
                <!-- –°–µ–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è –°–í–ï–†–•–£ -->
                <div class="add-ad-section">
                    <div class="add-ad-header">
                        <div class="add-ad-title">–†–∞–∑–º–µ—Å—Ç–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</div>
                        <button class="toggle-form-btn" onclick="toggleAddForm()" id="addAdButton">
                            <i class="fas fa-plus-circle"></i>
                            <span id="toggle-btn-text">–î–æ–±–∞–≤–∏—Ç—å</span>
                        </button>
                    </div>
                    
                    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
                    <div class="add-ad-form" id="addAdForm">
                        <!-- –°–∫—Ä—ã—Ç—ã–π input –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ -->
                        <input type="file" id="photoInput" class="hidden-file-input" accept="image/*" multiple 
                               onchange="handlePhotoUpload(event)">
                        
                        <div class="photo-upload-section">
                            <div class="photo-gallery" id="uploaded-photos">
                                <div class="photo-item" onclick="openPhotoPicker()">
                                    <div class="photo-placeholder" id="photo-placeholder-1">
                                        <i class="fas fa-plus"></i>
                                        <span>–§–æ—Ç–æ 1</span>
                                    </div>
                                </div>
                                <div class="photo-item" onclick="openPhotoPicker()">
                                    <div class="photo-placeholder" id="photo-placeholder-2">
                                        <i class="fas fa-plus"></i>
                                        <span>–§–æ—Ç–æ 2</span>
                                    </div>
                                </div>
                                <div class="photo-item" onclick="openPhotoPicker()">
                                    <div class="photo-placeholder" id="photo-placeholder-3">
                                        <i class="fas fa-plus"></i>
                                        <span>–§–æ—Ç–æ 3</span>
                                    </div>
                                </div>
                            </div>
                            
                            <button class="upload-btn" onclick="openPhotoPicker()">
                                <i class="fas fa-images"></i>
                                –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
                            </button>
                            <div class="upload-info">
                                –ú–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ 3 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π. –í—ã–±—Ä–∞–Ω–æ: <span id="photo-count">0</span>/3
                            </div>
                        </div>

                        <input type="text" class="form-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" id="adTitle">
                        
                        <select class="form-input" id="adCategory">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                            <option value="liquids">–ñ–∏–¥–∫–æ—Å—Ç–∏</option>
                            <option value="disposable">–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</option>
                            <option value="pod">–ü–æ–¥-—Å–∏—Å—Ç–µ–º—ã</option>
                            <option value="consumables">–†–∞—Å—Ö–æ–¥–Ω–∏–∫–∏</option>
                        </select>
                        
                        <input type="number" class="form-input" placeholder="–¶–µ–Ω–∞ (‚ÇΩ)" id="adPrice">
                        
                        <textarea class="form-input" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" id="adDescription" rows="3"></textarea>
                        
                        <div class="form-buttons">
                            <button class="publish-btn" onclick="publishAd()">
                                <i class="fas fa-paper-plane"></i>
                                –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å
                            </button>
                            <button class="cancel-btn" onclick="toggleAddForm()">
                                <i class="fas fa-times"></i>
                                –û—Ç–º–µ–Ω–∞
                            </button>
                        </div>
                    </div>
                </div>

                <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
                <div class="categories">
                    <button class="category-btn active" onclick="filterCategory('all')">–í—Å–µ</button>
                    <button class="category-btn" onclick="filterCategory('liquids')">–ñ–∏–¥–∫–æ—Å—Ç–∏</button>
                    <button class="category-btn" onclick="filterCategory('disposable')">–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ</button>
                    <button class="category-btn" onclick="filterCategory('pod')">–ü–æ–¥-—Å–∏—Å—Ç–µ–º—ã</button>
                    <button class="category-btn" onclick="filterCategory('consumables')">–†–∞—Å—Ö–æ–¥–Ω–∏–∫–∏</button>
                </div>

                <!-- –û–±—ä—è–≤–ª–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å -->
                <div id="ads-container"></div>
            </div>

            <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 2: –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç -->
            <div class="page" id="page-profile">
                <div class="profile-card">
                    <div class="profile-header">
                        <div class="profile-avatar" id="profileAvatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="profile-info">
                            <h2 id="profileName">–ó–∞–≥—Ä—É–∑–∫–∞...</h2>
                            <p id="profileUsername">@username</p>
                            <div class="seller-stat stat-rating">
                                <i class="fas fa-star"></i>
                                <span id="myRating">0.0</span>
                            </div>
                        </div>
                    </div>

                    <div class="profile-stats">
                        <div class="profile-stat">
                            <div class="stat-number" id="myAdsCount">0</div>
                            <div class="stat-label">–û–±—ä—è–≤–ª–µ–Ω–∏—è</div>
                        </div>
                        <div class="profile-stat">
                            <div class="stat-number" id="myLikesCount">0</div>
                            <div class="stat-label">–õ–∞–π–∫–∏</div>
                        </div>
                        <div class="profile-stat">
                            <div class="stat-number" id="myDislikesCount">0</div>
                            <div class="stat-label">–î–∏–∑–ª–∞–π–∫–∏</div>
                        </div>
                    </div>

                    <!-- –í–∫–ª–∞–¥–∫–∏ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ -->
                    <div class="profile-tabs">
                        <div class="profile-tab active" onclick="switchProfileTab('my-ads')">
                            –ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
                        </div>
                        <div class="profile-tab" onclick="switchProfileTab('history')">
                            –ò—Å—Ç–æ—Ä–∏—è
                        </div>
                    </div>

                    <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–∫–∏ "–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è" -->
                    <div class="profile-tab-content active" id="my-ads-tab">
                        <div class="my-ads-list" id="myAdsList">
                            <!-- –ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                        </div>
                    </div>

                    <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–∫–∏ "–ò—Å—Ç–æ—Ä–∏—è" -->
                    <div class="profile-tab-content" id="history-tab">
                        <div class="history-list" id="historyList">
                            <!-- –ò—Å—Ç–æ—Ä–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å -->
                        </div>
                        
                        <button class="cancel-btn" onclick="clearHistory()" style="width: 100%; margin-top: 10px;">
                            <i class="fas fa-trash"></i>
                            –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
                        </button>
                    </div>
                </div>
            </div>

            <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 3: FAQ -->
            <div class="page" id="page-faq">
                <div class="profile-card">
                    <div class="profile-header">
                        <div class="profile-avatar" style="background: var(--gradient-primary);">
                            <i class="fas fa-question-circle"></i>
                        </div>
                        <div class="profile-info">
                            <h2>–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h2>
                            <p>–ü–æ–º–æ—â—å –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é</p>
                        </div>
                    </div>

                    <div class="faq-list">
                        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
                        <div class="faq-item" onclick="toggleFaq(0)">
                            <div class="faq-question">
                                <span>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</span>
                                <i class="fas fa-chevron-down" id="faq-icon-0"></i>
                            </div>
                            <div class="faq-answer" id="faq-answer-0" style="display: none;">
                                <div class="stats-grid">
                                    <div class="stat-box">
                                        <div class="stat-number" id="stats-users">0</div>
                                        <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                                    </div>
                                    <div class="stat-box">
                                        <div class="stat-number" id="stats-ads">0</div>
                                        <div class="stat-label">–û–±—ä—è–≤–ª–µ–Ω–∏–π</div>
                                    </div>
                                    <div class="stat-box">
                                        <div class="stat-number" id="stats-likes">0</div>
                                        <div class="stat-label">–õ–∞–π–∫–æ–≤</div>
                                    </div>
                                    <div class="stat-box">
                                        <div class="stat-number" id="stats-dislikes">0</div>
                                        <div class="stat-label">–î–∏–∑–ª–∞–π–∫–æ–≤</div>
                                    </div>
                                </div>
                                
                                <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –∞–¥–º–∏–Ω–∞ -->
                                <div class="admin-controls" id="adminControls" style="display: none;">
                                    <button class="admin-btn blue" onclick="refreshStats()">
                                        <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                                    </button>
                                    <button class="admin-btn red" onclick="clearAllData()">
                                        <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="faq-item" onclick="toggleFaq(1)">
                            <div class="faq-question">
                                <span>–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ?</span>
                                <i class="fas fa-chevron-down" id="faq-icon-1"></i>
                            </div>
                            <div class="faq-answer" id="faq-answer-1" style="display: none;">
                                –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å" —Å–≤–µ—Ä—Ö—É. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –¥–æ 3 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –∏–∑ –≥–∞–ª–µ—Ä–µ–∏.
                            </div>
                        </div>
                        
                        <div class="faq-item" onclick="toggleFaq(2)">
                            <div class="faq-question">
                                <span>–ö–∞–∫ —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞?</span>
                                <i class="fas fa-chevron-down" id="faq-icon-2"></i>
                            </div>
                            <div class="faq-answer" id="faq-answer-2" style="display: none;">
                                –†–µ–π—Ç–∏–Ω–≥ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ: 0.1 + (–ª–∞–π–∫–∏ / (–ª–∞–π–∫–∏ + –¥–∏–∑–ª–∞–π–∫–∏)) √ó 4.9. 
                                –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –æ—Ü–µ–Ω–∫—É.
                            </div>
                        </div>
                        
                        <div class="faq-item" onclick="toggleFaq(3)">
                            <div class="faq-question">
                                <span>–ö–∞–∫ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ?</span>
                                <i class="fas fa-chevron-down" id="faq-icon-3"></i>
                            </div>
                            <div class="faq-answer" id="faq-answer-3" style="display: none;">
                                –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø–æ–ª–µ –¥–ª—è —Ñ–æ—Ç–æ ‚Üí "–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏" ‚Üí –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≥–∞–ª–µ—Ä–µ—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞. 
                                –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –¥–æ 3 —Ñ–æ—Ç–æ –∑–∞ –æ–¥–∏–Ω —Ä–∞–∑.
                            </div>
                        </div>
                        
                        <div class="faq-item" onclick="toggleFaq(4)">
                            <div class="faq-question">
                                <span>–ö–∞–∫ –Ω–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ–¥–∞–≤—Ü—É?</span>
                                <i class="fas fa-chevron-down" id="faq-icon-4"></i>
                            </div>
                            <div class="faq-answer" id="faq-answer-4" style="display: none;">
                                –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ù–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ–¥–∞–≤—Ü—É". –í —á–∞—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ 
                                –æ —Ç–æ–≤–∞—Ä–µ –∏ –µ–≥–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
                            </div>
                        </div>
                        
                        <div class="faq-item" onclick="toggleFaq(5)">
                            <div class="faq-question">
                                <span>–ö–∞–∫ –æ–ø–ª–∞—á–∏–≤–∞—Ç—å —Ç–æ–≤–∞—Ä?</span>
                                <i class="fas fa-chevron-down" id="faq-icon-5"></i>
                            </div>
                            <div class="faq-answer" id="faq-answer-5" style="display: none;">
                                –í—Å–µ —Å–¥–µ–ª–∫–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –Ω–∞–ø—Ä—è–º—É—é —Å –ø—Ä–æ–¥–∞–≤—Ü–æ–º –≤ Telegram. 
                                –î–æ–≥–æ–≤–∞—Ä–∏–≤–∞–π—Ç–µ—Å—å –æ–± –æ–ø–ª–∞—Ç–µ –≤ –ª–∏—á–Ω–æ–º —á–∞—Ç–µ.
                            </div>
                        </div>
                    </div>

                    <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–¥–∞—á–∏ –∂–∞–ª–æ–±—ã -->
                    <button class="complaint-btn" onclick="submitComplaint()">
                        <i class="fas fa-exclamation-triangle"></i>
                        –ü–æ–¥–∞—Ç—å –∂–∞–ª–æ–±—É
                    </button>
                </div>
            </div>
        </main>

        <!-- –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
        <nav class="bottom-nav">
            <button class="nav-item active" data-page="ads" onclick="switchPage('ads')">
                <div class="nav-icon">
                    <i class="fas fa-box-open"></i>
                </div>
                <span class="nav-label">–û–±—ä—è–≤–ª–µ–Ω–∏—è</span>
            </button>
            
            <button class="nav-item" data-page="profile" onclick="switchPage('profile')">
                <div class="nav-icon">
                    <i class="fas fa-user-circle"></i>
                </div>
                <span class="nav-label">–ö–∞–±–∏–Ω–µ—Ç</span>
            </button>
            
            <button class="nav-item" data-page="faq" onclick="switchPage('faq')">
                <div class="nav-icon">
                    <i class="fas fa-question-circle"></i>
                </div>
                <span class="nav-label">FAQ</span>
            </button>
        </nav>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ñ–æ—Ç–æ -->
        <div class="photo-modal" id="photoModal">
            <button class="photo-modal-close" onclick="closePhotoModal()">
                <i class="fas fa-times"></i>
            </button>
            <div class="photo-modal-nav">
                <button class="photo-modal-nav-btn" onclick="prevPhoto()">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="photo-modal-nav-btn" onclick="nextPhoto()">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            <img class="photo-modal-img" id="modalPhoto" src="" alt="–ü—Ä–æ—Å–º–æ—Ç—Ä —Ñ–æ—Ç–æ">
            <div class="photo-modal-counter" id="photoCounter">1 / 1</div>
        </div>

        <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
        <div class="notification" id="notification"></div>
    </div>

    <script>
        // ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
        
        // Telegram Web App
        const tg = window.Telegram?.WebApp;
        
        // –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        let currentUser = null;
        
        // –°–∏—Å—Ç–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const appData = {
            // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ localStorage)
            STORAGE_KEYS: {
                ADS: 'vapeMarketAdsGlobal',
                RATINGS: 'vapeMarketRatingsGlobal',
                USERS: 'vapeMarketUsersGlobal',
                HISTORY: 'vapeMarketHistory_',
                LAST_SYNC: 'vapeMarketLastSync'
            },
            
            // –õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            userId: null,
            userData: null,
            history: [],
            uploadedPhotoUrls: [],
            uploadedPhotoFiles: [],
            currentPhotoList: [],
            currentPhotoIndex: 0,
            currentCategory: 'all',
            editingAdId: null,
            nextAdId: Date.now()
        };
        
        // ==================== –ü–†–û–í–ï–†–ö–ê T–ïLEGRAM ====================
        
        function checkTelegram() {
            if (!tg) {
                // –ï—Å–ª–∏ –Ω–µ Telegram, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
                document.getElementById('browserError').style.display = 'flex';
                document.getElementById('appContainer').style.display = 'none';
                return false;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const user = tg.initDataUnsafe?.user;
            if (!user || !user.id) {
                document.getElementById('browserError').style.display = 'flex';
                document.getElementById('appContainer').style.display = 'none';
                return false;
            }
            
            return true;
        }
        
        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø ====================
        
        function initializeUser() {
            if (!tg) return;
            
            const user = tg.initDataUnsafe?.user;
            
            currentUser = {
                id: user.id.toString(),
                name: user.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                username: user.username ? '@' + user.username : null,
                photo_url: user.photo_url || null
            };
            
            appData.userId = currentUser.id;
            appData.userData = currentUser;
            
            // –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –±–∞–∑–µ
            registerUserInSystem();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            loadUserHistory();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            initApp();
        }
        
        // ==================== –ì–õ–û–ë–ê–õ–¨–ù–ê–Ø –ë–ê–ó–ê –î–ê–ù–ù–´–• ====================
        
        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º–µ
        function registerUserInSystem() {
            try {
                const users = getAllUsers();
                if (!users[currentUser.id]) {
                    users[currentUser.id] = {
                        name: currentUser.name,
                        username: currentUser.username,
                        registrationDate: new Date().toISOString(),
                        lastActive: new Date().toISOString()
                    };
                    localStorage.setItem(appData.STORAGE_KEYS.USERS, JSON.stringify(users));
                    console.log('‚úÖ –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:', currentUser.id);
                } else {
                    // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
                    users[currentUser.id].lastActive = new Date().toISOString();
                    localStorage.setItem(appData.STORAGE_KEYS.USERS, JSON.stringify(users));
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
            }
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
        function getAllAds() {
            try {
                const adsData = localStorage.getItem(appData.STORAGE_KEYS.ADS);
                return adsData ? JSON.parse(adsData) : [];
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–π:', error);
                return [];
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
        function saveAllAds(ads) {
            try {
                localStorage.setItem(appData.STORAGE_KEYS.ADS, JSON.stringify(ads));
                localStorage.setItem(appData.STORAGE_KEYS.LAST_SYNC, Date.now().toString());
                return true;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π:', error);
                return false;
            }
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ä–µ–π—Ç–∏–Ω–≥–∏
        function getAllRatings() {
            try {
                const ratingsData = localStorage.getItem(appData.STORAGE_KEYS.RATINGS);
                return ratingsData ? JSON.parse(ratingsData) : {};
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤:', error);
                return {};
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ —Ä–µ–π—Ç–∏–Ω–≥–∏
        function saveAllRatings(ratings) {
            try {
                localStorage.setItem(appData.STORAGE_KEYS.RATINGS, JSON.stringify(ratings));
                return true;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–æ–≤:', error);
                return false;
            }
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function getAllUsers() {
            try {
                const usersData = localStorage.getItem(appData.STORAGE_KEYS.USERS);
                return usersData ? JSON.parse(usersData) : {};
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:', error);
                return {};
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function loadUserHistory() {
            try {
                const historyData = localStorage.getItem(appData.STORAGE_KEYS.HISTORY + currentUser.id);
                appData.history = historyData ? JSON.parse(historyData) : [];
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏:', error);
                appData.history = [];
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function saveUserHistory() {
            try {
                localStorage.setItem(
                    appData.STORAGE_KEYS.HISTORY + currentUser.id, 
                    JSON.stringify(appData.history)
                );
                return true;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏:', error);
                return false;
            }
        }
        
        // ==================== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function initApp() {
            if (!tg || !currentUser) return;
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Web App
            tg.expand();
            tg.ready();
            tg.setHeaderColor('#6D28D9');
            tg.setBackgroundColor('#7C3AED');
            
            // –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥"
            tg.BackButton.show();
            tg.BackButton.onClick(function() {
                tg.close();
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            document.getElementById('browserError').style.display = 'none';
            document.getElementById('appContainer').style.display = 'flex';
            
            // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
            updateUserProfile();
            
            // –†–µ–Ω–¥–µ—Ä–∏–º –æ–±—ä—è–≤–ª–µ–Ω–∏—è
            renderAds();
            
            // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ—Ñ–∏–ª—è
            updateProfileStats();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–¥–º–∏–Ω–∞
            checkAdminStatus();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è FAQ
            for (let i = 0; i <= 5; i++) {
                document.getElementById(`faq-answer-${i}`).style.display = 'none';
            }
            
            showNotification(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${currentUser.name}!`, 'success');
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function updateUserProfile() {
            if (!currentUser) return;
            
            document.getElementById('profileName').textContent = currentUser.name;
            document.getElementById('profileUsername').textContent = currentUser.username || '–ë–µ–∑ username';
            
            const profileAvatar = document.getElementById('profileAvatar');
            if (currentUser.photo_url) {
                profileAvatar.innerHTML = `<img src="${currentUser.photo_url}" alt="–ê–≤–∞—Ç–∞—Ä">`;
            } else {
                const firstLetter = currentUser.name.charAt(0).toUpperCase();
                profileAvatar.innerHTML = `<span style="font-size: 28px; font-weight: bold;">${firstLetter}</span>`;
            }
        }
        
        // ==================== –û–ë–™–Ø–í–õ–ï–ù–ò–Ø ====================
        
        // –†–µ–Ω–¥–µ—Ä –æ–±—ä—è–≤–ª–µ–Ω–∏–π
        function renderAds() {
            const container = document.getElementById('ads-container');
            container.innerHTML = '';
            
            const allAds = getAllAds();
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            const filteredAds = appData.currentCategory === 'all' 
                ? allAds 
                : allAds.filter(ad => ad.category === appData.currentCategory);
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
            filteredAds.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
            
            if (filteredAds.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: rgba(255,255,255,0.7);">
                        <i class="fas fa-box-open" style="font-size: 48px; margin-bottom: 20px; opacity: 0.5;"></i>
                        <h3 style="margin-bottom: 10px;">–ù–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π</h3>
                        <p>–í —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–∫–∞ –Ω–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π</p>
                        <p style="font-size: 12px; margin-top: 10px; color: rgba(255,255,255,0.5);">
                            –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º - —Å–æ–∑–¥–∞–π—Ç–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ!
                        </p>
                    </div>
                `;
                return;
            }
            
            filteredAds.forEach(ad => {
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–µ–π—Ç–∏–Ω–≥ –ø—Ä–æ–¥–∞–≤—Ü–∞
                const rating = calculateRating(ad.sellerId);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ü–µ–Ω–∫—É —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const allRatings = getAllRatings();
                const userRating = allRatings[ad.sellerId]?.[currentUser.id];
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–≤–æ–µ –ª–∏ —ç—Ç–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
                const isOwnAd = ad.sellerId === currentUser.id;
                
                const adElement = document.createElement('div');
                adElement.className = 'advertisement-card';
                adElement.id = `ad-${ad.id}`;
                
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ñ–æ—Ç–æ
                const photoElements = [];
                if (ad.photoUrls && ad.photoUrls.length > 0) {
                    ad.photoUrls.forEach((photoUrl, index) => {
                        photoElements.push(`
                            <div class="photo-item" onclick="openPhotoViewer(${ad.id}, ${index})">
                                <img src="${photoUrl}" alt="–§–æ—Ç–æ ${index + 1}">
                                <div class="photo-label">–§–æ—Ç–æ ${index + 1}</div>
                            </div>
                        `);
                    });
                }
                
                adElement.innerHTML = `
                    <div class="seller-header">
                        <div class="seller-avatar">
                            ${ad.sellerAvatar ? `<img src="${ad.sellerAvatar}" alt="–ê–≤–∞—Ç–∞—Ä">` : 
                              `<span style="font-size: 18px; font-weight: bold;">${ad.sellerName?.charAt(0) || '–ü'}</span>`}
                        </div>
                        <div class="seller-info">
                            <div class="seller-name">${ad.sellerName}</div>
                            <div class="seller-username">${ad.sellerUsername}</div>
                            <div class="seller-stats">
                                <div class="seller-stat stat-rating">
                                    <i class="fas fa-star"></i>
                                    <span>${rating.toFixed(1)}</span>
                                </div>
                                <div class="seller-stat stat-likes">
                                    <i class="fas fa-thumbs-up"></i>
                                    <span id="ad${ad.id}-likes">${ad.likes}</span>
                                </div>
                                <div class="seller-stat stat-dislikes">
                                    <i class="fas fa-thumbs-down"></i>
                                    <span id="ad${ad.id}-dislikes">${ad.dislikes}</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="photo-gallery">
                        ${photoElements.join('')}
                    </div>

                    <div class="product-info">
                        <div class="product-title">${ad.title}</div>
                        <div class="product-category">${getCategoryName(ad.category)}</div>
                        <div class="product-price">${ad.price.toLocaleString()} ‚ÇΩ</div>
                        <div class="product-description">${ad.description}</div>
                    </div>

                    <div class="action-grid">
                        <button class="rate-btn like-btn ${userRating === 'like' ? 'active' : ''} ${isOwnAd ? 'disabled' : ''}" 
                                onclick="rateSeller('${ad.sellerId}', 'like', ${ad.id})"
                                ${isOwnAd ? 'disabled' : ''}>
                            <i class="fas fa-thumbs-up"></i>
                        </button>
                        
                        <button class="contact-btn" onclick="contactSeller('${ad.sellerUsername}', ${ad.id}, '${ad.title}', '${ad.category}', ${ad.price})">
                            <i class="fas fa-paper-plane"></i>
                            –ù–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ–¥–∞–≤—Ü—É
                        </button>
                        
                        <button class="rate-btn dislike-btn ${userRating === 'dislike' ? 'active' : ''} ${isOwnAd ? 'disabled' : ''}" 
                                onclick="rateSeller('${ad.sellerId}', 'dislike', ${ad.id})"
                                ${isOwnAd ? 'disabled' : ''}>
                            <i class="fas fa-thumbs-down"></i>
                        </button>
                    </div>
                `;
                
                container.appendChild(adElement);
            });
        }
        
        // –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ä–µ–π—Ç–∏–Ω–≥
        function calculateRating(sellerId) {
            const allRatings = getAllRatings();
            if (!allRatings[sellerId]) return 0.1;
            
            const ratings = Object.values(allRatings[sellerId]);
            if (ratings.length === 0) return 0.1;
            
            const likes = ratings.filter(r => r === 'like').length;
            const dislikes = ratings.filter(r => r === 'dislike').length;
            const total = likes + dislikes;
            
            if (total === 0) return 0.1;
            return 0.1 + (likes / total) * 4.9;
        }
        
        // –û—Ü–µ–Ω–∏—Ç—å –ø—Ä–æ–¥–∞–≤—Ü–∞
        function rateSeller(sellerId, type, adId) {
            const allAds = getAllAds();
            const allRatings = getAllRatings();
            
            const ad = allAds.find(a => a.id === adId);
            if (!ad) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å–≤–æ–µ –ª–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
            if (ad.sellerId === currentUser.id) {
                showNotification('–ù–µ–ª—å–∑—è –æ—Ü–µ–Ω–∏–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ', 'warning');
                return;
            }
            
            const userRating = allRatings[sellerId]?.[currentUser.id];
            
            if (userRating === type) {
                showNotification('–í—ã —É–∂–µ –ø–æ—Å—Ç–∞–≤–∏–ª–∏ —ç—Ç—É –æ—Ü–µ–Ω–∫—É', 'warning');
                return;
            }
            
            // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é –æ—Ü–µ–Ω–∫—É
            if (userRating === 'like') {
                ad.likes--;
            } else if (userRating === 'dislike') {
                ad.dislikes--;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –æ—Ü–µ–Ω–∫—É
            if (type === 'like') {
                ad.likes++;
            } else {
                ad.dislikes++;
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ü–µ–Ω–∫—É
            if (!allRatings[sellerId]) {
                allRatings[sellerId] = {};
            }
            allRatings[sellerId][currentUser.id] = type;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
            saveAllAds(allAds);
            saveAllRatings(allRatings);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            renderAds();
            updateProfileStats();
            updateStatsInFAQ();
            
            showNotification(`–í—ã –ø–æ—Å—Ç–∞–≤–∏–ª–∏ ${type === 'like' ? '–ª–∞–π–∫' : '–¥–∏–∑–ª–∞–π–∫'}`, 'success');
        }
        
        // –ù–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ–¥–∞–≤—Ü—É
        function contactSeller(username, adId, title, category, price) {
            // –ù–∞—Ö–æ–¥–∏–º –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
            const allAds = getAllAds();
            const ad = allAds.find(a => a.id === adId);
            if (!ad) return;
            
            // –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            const categoryName = getCategoryName(category);
            const message = `–ü—Ä–∏–≤–µ—Ç! –í–∏–∂—É —Ç–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –≤ Vape Market:\n\n` +
                           `üì¶ –¢–æ–≤–∞—Ä: ${title}\n` +
                           `üè∑Ô∏è –ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${categoryName}\n` +
                           `üí∞ –¶–µ–Ω–∞: ${price.toLocaleString()} ‚ÇΩ\n\n` +
                           `–ú–æ–∂–µ—à—å —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ç–æ–≤–∞—Ä–µ?`;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
            const historyItem = {
                id: Date.now(),
                adId: adId,
                title: title,
                sellerUsername: username,
                date: new Date().toLocaleDateString('ru-RU'),
                category: categoryName,
                price: price
            };
            
            appData.history.unshift(historyItem);
            saveUserHistory();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏—Å—Ç–æ—Ä–∏—é –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è
            if (document.getElementById('page-profile').classList.contains('active')) {
                updateHistory();
            }
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º —á–∞—Ç –≤ Telegram
            try {
                const cleanUsername = username.replace('@', '');
                const encodedMessage = encodeURIComponent(message);
                const telegramUrl = `https://t.me/${cleanUsername}?text=${encodedMessage}`;
                
                tg.openTelegramLink(telegramUrl);
                showNotification(`–û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —á–∞—Ç —Å ${username}`, 'success');
            } catch (error) {
                tg.showAlert(`–î–ª—è —Å–≤—è–∑–∏ —Å –ø—Ä–æ–¥–∞–≤—Ü–æ–º –Ω–∞–ø–∏—à–∏—Ç–µ ${username} –≤ Telegram\n\n${message}`);
            }
        }
        
        // ==================== –§–û–†–ú–ê –î–û–ë–ê–í–õ–ï–ù–ò–Ø ====================
        
        // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ñ–æ—Ä–º—É
        function toggleAddForm() {
            const form = document.getElementById('addAdForm');
            const btnText = document.getElementById('toggle-btn-text');
            
            if (form.classList.contains('active')) {
                form.classList.remove('active');
                btnText.textContent = '–î–æ–±–∞–≤–∏—Ç—å';
            } else {
                form.classList.add('active');
                btnText.textContent = '–°–∫—Ä—ã—Ç—å';
            }
        }
        
        // –°–∫—Ä—ã—Ç—å —Ñ–æ—Ä–º—É
        function hideAddForm() {
            const form = document.getElementById('addAdForm');
            const btnText = document.getElementById('toggle-btn-text');
            
            form.classList.remove('active');
            btnText.textContent = '–î–æ–±–∞–≤–∏—Ç—å';
            clearAddForm();
        }
        
        // –û—Ç–∫—Ä—ã—Ç—å –≤—ã–±–æ—Ä —Ñ–æ—Ç–æ
        function openPhotoPicker() {
            document.getElementById('photoInput').click();
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ
        function handlePhotoUpload(event) {
            const files = event.target.files;
            const maxFiles = 3;
            
            if (files.length > maxFiles) {
                showNotification(`–ú–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–ª—å–∫–æ ${maxFiles} —Ñ–æ—Ç–æ!`, 'error');
                return;
            }
            
            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ñ–æ—Ç–æ
            appData.uploadedPhotoUrls = [];
            appData.uploadedPhotoFiles = [];
            
            // –û—á–∏—â–∞–µ–º –≤—Å–µ —Ñ–æ—Ç–æ-—Å–ª–æ—Ç—ã
            for (let i = 1; i <= 3; i++) {
                const placeholder = document.getElementById(`photo-placeholder-${i}`);
                placeholder.innerHTML = `<i class="fas fa-plus"></i><span>–§–æ—Ç–æ ${i}</span>`;
            }
            
            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—ã–π —Ñ–∞–π–ª
            Array.from(files).forEach((file, index) => {
                if (index >= maxFiles) return;
                
                const slotNumber = index + 1;
                const placeholder = document.getElementById(`photo-placeholder-${slotNumber}`);
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    placeholder.innerHTML = `
                        <img src="${e.target.result}" alt="–§–æ—Ç–æ ${slotNumber}">
                        <div class="photo-label">–§–æ—Ç–æ ${slotNumber}</div>
                        <div style="position: absolute; top: 5px; right: 5px; background: rgba(0,0,0,0.7); 
                             color: white; width: 20px; height: 20px; border-radius: 50%; 
                             display: flex; align-items: center; justify-content: center; 
                             font-size: 12px; cursor: pointer;" 
                             onclick="removePhoto(${slotNumber}, event)">√ó</div>
                    `;
                    
                    appData.uploadedPhotoUrls.push(e.target.result);
                };
                reader.readAsDataURL(file);
                
                appData.uploadedPhotoFiles.push(file);
            });
            
            document.getElementById('photo-count').textContent = files.length;
            
            showNotification(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${files.length} —Ñ–æ—Ç–æ`, 'success');
            event.target.value = '';
        }
        
        // –£–¥–∞–ª–∏—Ç—å —Ñ–æ—Ç–æ
        function removePhoto(photoNum, event) {
            if (event) event.stopPropagation();
            
            const placeholder = document.getElementById(`photo-placeholder-${photoNum}`);
            placeholder.innerHTML = `<i class="fas fa-plus"></i><span>–§–æ—Ç–æ ${photoNum}</span>`;
            
            // –£–¥–∞–ª—è–µ–º –∏–∑ –º–∞—Å—Å–∏–≤–æ–≤
            const index = photoNum - 1;
            if (index >= 0 && index < appData.uploadedPhotoUrls.length) {
                appData.uploadedPhotoUrls.splice(index, 1);
                appData.uploadedPhotoFiles.splice(index, 1);
            }
            
            // –°–¥–≤–∏–≥–∞–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ
            for (let i = 1; i <= 3; i++) {
                const placeholder = document.getElementById(`photo-placeholder-${i}`);
                if (i <= appData.uploadedPhotoUrls.length) {
                    placeholder.innerHTML = `
                        <img src="${appData.uploadedPhotoUrls[i-1]}" alt="–§–æ—Ç–æ ${i}">
                        <div class="photo-label">–§–æ—Ç–æ ${i}</div>
                        <div style="position: absolute; top: 5px; right: 5px; background: rgba(0,0,0,0.7); 
                             color: white; width: 20px; height: 20px; border-radius: 50%; 
                             display: flex; align-items: center; justify-content: center; 
                             font-size: 12px; cursor: pointer;" 
                             onclick="removePhoto(${i}, event)">√ó</div>
                    `;
                } else {
                    placeholder.innerHTML = `<i class="fas fa-plus"></i><span>–§–æ—Ç–æ ${i}</span>`;
                }
            }
            
            document.getElementById('photo-count').textContent = appData.uploadedPhotoUrls.length;
            showNotification(`–§–æ—Ç–æ —É–¥–∞–ª–µ–Ω–æ (${appData.uploadedPhotoUrls.length}/3)`, 'warning');
        }
        
        // –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É
        function clearAddForm() {
            document.getElementById('adTitle').value = '';
            document.getElementById('adCategory').value = '';
            document.getElementById('adPrice').value = '';
            document.getElementById('adDescription').value = '';
            
            // –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
            for (let i = 1; i <= 3; i++) {
                const placeholder = document.getElementById(`photo-placeholder-${i}`);
                placeholder.innerHTML = `<i class="fas fa-plus"></i><span>–§–æ—Ç–æ ${i}</span>`;
            }
            
            appData.uploadedPhotoUrls = [];
            appData.uploadedPhotoFiles = [];
            document.getElementById('photo-count').textContent = '0';
            
            appData.editingAdId = null;
        }
        
        // –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
        function publishAd() {
            const title = document.getElementById('adTitle').value.trim();
            const category = document.getElementById('adCategory').value;
            const price = parseInt(document.getElementById('adPrice').value);
            const description = document.getElementById('adDescription').value.trim();
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è
            if (!title) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞!', 'error');
                return;
            }
            
            if (!category) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é!', 'error');
                return;
            }
            
            if (!price || isNaN(price) || price <= 0) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ü–µ–Ω—É!', 'error');
                return;
            }
            
            if (appData.uploadedPhotoUrls.length === 0) {
                showNotification('–î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é!', 'error');
                return;
            }
            
            const allAds = getAllAds();
            
            // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
            if (appData.editingAdId) {
                const ad = allAds.find(a => a.id === appData.editingAdId);
                if (ad && ad.sellerId === currentUser.id) {
                    ad.title = title;
                    ad.category = category;
                    ad.price = price;
                    ad.description = description || '–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è';
                    ad.photoUrls = [...appData.uploadedPhotoUrls];
                    ad.photos = appData.uploadedPhotoUrls.length;
                    ad.updatedAt = new Date().toISOString();
                    
                    saveAllAds(allAds);
                    renderAds();
                    updateProfileStats();
                    updateMyAdsList();
                    hideAddForm();
                    
                    appData.editingAdId = null;
                    showNotification('–û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ!', 'success');
                }
                return;
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
            const newAd = {
                id: appData.nextAdId++,
                sellerId: currentUser.id,
                sellerName: currentUser.name,
                sellerUsername: currentUser.username || '–ë–µ–∑ username',
                sellerAvatar: currentUser.photo_url || null,
                title: title,
                category: category,
                price: price,
                description: description || '–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è',
                photos: appData.uploadedPhotoUrls.length,
                photoUrls: [...appData.uploadedPhotoUrls],
                likes: 0,
                dislikes: 0,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            allAds.unshift(newAd);
            saveAllAds(allAds);
            
            updateProfileStats();
            updateMyAdsList();
            renderAds();
            hideAddForm();
            
            showNotification('–û–±—ä—è–≤–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ!', 'success');
        }
        
        // ==================== –õ–ò–ß–ù–´–ô –ö–ê–ë–ò–ù–ï–¢ ====================
        
        // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ—Ñ–∏–ª—è
        function updateProfileStats() {
            const allAds = getAllAds();
            const myAds = allAds.filter(ad => ad.sellerId === currentUser.id);
            
            document.getElementById('myAdsCount').textContent = myAds.length;
            
            let myLikes = 0;
            let myDislikes = 0;
            
            myAds.forEach(ad => {
                myLikes += ad.likes;
                myDislikes += ad.dislikes;
            });
            
            document.getElementById('myLikesCount').textContent = myLikes;
            document.getElementById('myDislikesCount').textContent = myDislikes;
            
            const myRating = calculateRating(currentUser.id);
            document.getElementById('myRating').textContent = myRating.toFixed(1);
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–æ–∏—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π
        function updateMyAdsList() {
            const myAdsList = document.getElementById('myAdsList');
            const allAds = getAllAds();
            const myAds = allAds.filter(ad => ad.sellerId === currentUser.id);
            
            if (myAds.length === 0) {
                myAdsList.innerHTML = '<div style="text-align: center; color: #D8B4FE; padding: 20px;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π</div>';
                return;
            }
            
            myAdsList.innerHTML = '';
            
            myAds.forEach(ad => {
                const rating = calculateRating(currentUser.id);
                
                const adElement = document.createElement('div');
                adElement.className = 'my-ad-item';
                
                adElement.innerHTML = `
                    <div class="my-ad-header">
                        <div class="my-ad-title">${ad.title}</div>
                        <div class="my-ad-price">${ad.price.toLocaleString()} ‚ÇΩ</div>
                    </div>
                    <div class="product-category" style="display: inline-block; margin-bottom: 10px;">
                        ${getCategoryName(ad.category)}
                    </div>
                    <div class="my-ad-description">${ad.description}</div>
                    <div style="display: flex; gap: 15px; font-size: 12px; color: #D8B4FE;">
                        <div><i class="fas fa-thumbs-up"></i> ${ad.likes}</div>
                        <div><i class="fas fa-thumbs-down"></i> ${ad.dislikes}</div>
                        <div><i class="fas fa-star"></i> ${rating.toFixed(1)}</div>
                    </div>
                    <div class="my-ad-actions">
                        <button class="edit-ad-btn" onclick="editAd(${ad.id})">
                            <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                        <button class="delete-ad-btn" onclick="deleteAd(${ad.id})">
                            <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                `;
                myAdsList.appendChild(adElement);
            });
        }
        
        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
        function editAd(adId) {
            const allAds = getAllAds();
            const ad = allAds.find(a => a.id === adId);
            
            if (!ad || ad.sellerId !== currentUser.id) {
                showNotification('–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±—ä—è–≤–ª–µ–Ω–∏—é', 'error');
                return;
            }
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('adTitle').value = ad.title;
            document.getElementById('adCategory').value = ad.category;
            document.getElementById('adPrice').value = ad.price;
            document.getElementById('adDescription').value = ad.description;
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–æ—Ç–æ
            appData.uploadedPhotoUrls = [...ad.photoUrls];
            for (let i = 1; i <= 3; i++) {
                const placeholder = document.getElementById(`photo-placeholder-${i}`);
                if (i <= ad.photoUrls.length) {
                    placeholder.innerHTML = `
                        <img src="${ad.photoUrls[i-1]}" alt="–§–æ—Ç–æ ${i}">
                        <div class="photo-label">–§–æ—Ç–æ ${i}</div>
                        <div style="position: absolute; top: 5px; right: 5px; background: rgba(0,0,0,0.7); 
                             color: white; width: 20px; height: 20px; border-radius: 50%; 
                             display: flex; align-items: center; justify-content: center; 
                             font-size: 12px; cursor: pointer;" 
                             onclick="removePhoto(${i}, event)">√ó</div>
                    `;
                } else {
                    placeholder.innerHTML = `<i class="fas fa-plus"></i><span>–§–æ—Ç–æ ${i}</span>`;
                }
            }
            
            document.getElementById('photo-count').textContent = ad.photoUrls.length;
            
            // –ü–æ–º–µ—á–∞–µ–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
            appData.editingAdId = adId;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
            toggleAddForm();
            
            showNotification('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è', 'info');
        }
        
        // –£–¥–∞–ª–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
        function deleteAd(adId) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ?')) {
                return;
            }
            
            const allAds = getAllAds();
            const adIndex = allAds.findIndex(a => a.id === adId && a.sellerId === currentUser.id);
            
            if (adIndex === -1) {
                showNotification('–û–±—ä—è–≤–ª–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ', 'error');
                return;
            }
            
            allAds.splice(adIndex, 1);
            saveAllAds(allAds);
            
            renderAds();
            updateProfileStats();
            updateMyAdsList();
            showNotification('–û–±—ä—è–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ', 'warning');
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
        function updateHistory() {
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = '';
            
            if (appData.history.length === 0) {
                historyList.innerHTML = '<div style="text-align: center; color: #D8B4FE; padding: 20px;">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</div>';
                return;
            }
            
            appData.history.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.innerHTML = `
                    <div class="history-info">
                        <h4>${item.title}</h4>
                        <p>${item.sellerUsername} ‚Ä¢ ${item.category} ‚Ä¢ ${item.price.toLocaleString()} ‚ÇΩ ‚Ä¢ ${item.date}</p>
                    </div>
                    <button class="remove-history-btn" onclick="removeFromHistory(${item.id})">
                        –£–¥–∞–ª–∏—Ç—å
                    </button>
                `;
                historyList.appendChild(historyItem);
            });
        }
        
        // –£–¥–∞–ª–∏—Ç—å –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
        function removeFromHistory(id) {
            appData.history = appData.history.filter(item => item.id !== id);
            saveUserHistory();
            updateHistory();
            showNotification('–£–¥–∞–ª–µ–Ω–æ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏', 'warning');
        }
        
        // –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
        function clearHistory() {
            if (appData.history.length === 0) {
                showNotification('–ò—Å—Ç–æ—Ä–∏—è —É–∂–µ –ø—É—Å—Ç–∞', 'info');
                return;
            }
            
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é?')) {
                return;
            }
            
            appData.history = [];
            saveUserHistory();
            updateHistory();
            showNotification('–ò—Å—Ç–æ—Ä–∏—è –æ—á–∏—â–µ–Ω–∞', 'warning');
        }
        
        // ==================== FAQ –ò –°–¢–ê–¢–ò–°–¢–ò–ö–ê ====================
        
        // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ FAQ
        function updateStatsInFAQ() {
            const allUsers = getAllUsers();
            const allAds = getAllAds();
            const allRatings = getAllRatings();
            
            // –°—á–∏—Ç–∞–µ–º –æ–±—â–∏–µ –ª–∞–π–∫–∏ –∏ –¥–∏–∑–ª–∞–π–∫–∏
            let totalLikes = 0;
            let totalDislikes = 0;
            
            allAds.forEach(ad => {
                totalLikes += ad.likes;
                totalDislikes += ad.dislikes;
            });
            
            document.getElementById('stats-users').textContent = Object.keys(allUsers).length;
            document.getElementById('stats-ads').textContent = allAds.length;
            document.getElementById('stats-likes').textContent = totalLikes;
            document.getElementById('stats-dislikes').textContent = totalDislikes;
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        function refreshStats() {
            updateStatsInFAQ();
            showNotification('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞', 'success');
        }
        
        // –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞)
        function clearAllData() {
            if (!confirm('‚ùå –í–ù–ò–ú–ê–ù–ò–ï!\n\n–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ?\n\n–£–¥–∞–ª–∏—Ç—Å—è:\n‚Ä¢ –í—Å–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è\n‚Ä¢ –í—Å–µ —Ä–µ–π—Ç–∏–Ω–≥–∏\n‚Ä¢ –í—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –ù–ï–û–ë–†–ê–¢–ò–ú–û!')) {
                return;
            }
            
            localStorage.removeItem(appData.STORAGE_KEYS.ADS);
            localStorage.removeItem(appData.STORAGE_KEYS.RATINGS);
            localStorage.removeItem(appData.STORAGE_KEYS.USERS);
            localStorage.removeItem(appData.STORAGE_KEYS.LAST_SYNC);
            
            // –û—á–∏—â–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            const allUsers = getAllUsers();
            Object.keys(allUsers).forEach(userId => {
                localStorage.removeItem(appData.STORAGE_KEYS.HISTORY + userId);
            });
            
            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            renderAds();
            updateProfileStats();
            updateStatsInFAQ();
            
            showNotification('–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã', 'warning');
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∞–¥–º–∏–Ω–∞
        function checkAdminStatus() {
            const ADMIN_ID = '998579758'; // @nukm0
            
            if (currentUser.id === ADMIN_ID) {
                document.getElementById('adminControls').style.display = 'flex';
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —à–∞–ø–∫—É
                const header = document.querySelector('.app-header');
                const adminControls = document.createElement('div');
                adminControls.innerHTML = `
                    <div style="position: absolute; top: 15px; right: 15px; display: flex; gap: 5px;">
                        <button onclick="refreshStats()" style="
                            background: rgba(59, 130, 246, 0.3);
                            border: 1px solid rgba(59, 130, 246, 0.5);
                            color: white;
                            padding: 5px 10px;
                            border-radius: 10px;
                            font-size: 12px;
                            cursor: pointer;
                        ">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button onclick="clearAllData()" style="
                            background: rgba(239, 68, 68, 0.3);
                            border: 1px solid rgba(239, 68, 68, 0.5);
                            color: white;
                            padding: 5px 10px;
                            border-radius: 10px;
                            font-size: 12px;
                            cursor: pointer;
                        ">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                header.style.position = 'relative';
                header.appendChild(adminControls);
            }
        }
        
        // ==================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü
        function switchPage(page) {
            document.querySelectorAll('.page').forEach(p => {
                p.classList.remove('active');
            });
            
            document.getElementById(`page-${page}`).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-page="${page}"]`).classList.add('active');
            
            const titles = {
                'ads': 'Vape Market',
                'profile': '–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç',
                'faq': '–ü–æ–º–æ—â—å'
            };
            document.getElementById('header-title').textContent = titles[page] || 'Vape Market';
            
            hideAddForm();
            
            if (page === 'profile') {
                updateProfileStats();
                updateMyAdsList();
                updateHistory();
            } else if (page === 'faq') {
                updateStatsInFAQ();
            }
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫ –ø—Ä–æ—Ñ–∏–ª—è
        function switchProfileTab(tab) {
            document.querySelectorAll('.profile-tab').forEach(t => {
                t.classList.remove('active');
            });
            document.querySelector(`[onclick="switchProfileTab('${tab}')"]`).classList.add('active');
            
            document.querySelectorAll('.profile-tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tab}-tab`).classList.add('active');
        }
        
        // –§–∏–ª—å—Ç—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        function filterCategory(category) {
            appData.currentCategory = category;
            
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderAds();
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ FAQ
        function toggleFaq(id) {
            const answer = document.getElementById(`faq-answer-${id}`);
            const icon = document.getElementById(`faq-icon-${id}`);
            
            if (answer.style.display === 'none') {
                answer.style.display = 'block';
                icon.classList.replace('fa-chevron-down', 'fa-chevron-up');
            } else {
                answer.style.display = 'none';
                icon.classList.replace('fa-chevron-up', 'fa-chevron-down');
            }
        }
        
        // –ü–æ–¥–∞—Ç—å –∂–∞–ª–æ–±—É
        function submitComplaint() {
            const message = encodeURIComponent('–•–æ—á—É –ø–æ–¥–∞—Ç—å –∂–∞–ª–æ–±—É –≤ Vape Market!');
            const telegramUrl = `https://t.me/nukm0?text=${message}`;
            
            try {
                tg.openTelegramLink(telegramUrl);
                showNotification('–û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —á–∞—Ç –¥–ª—è –ø–æ–¥–∞—á–∏ –∂–∞–ª–æ–±—ã', 'info');
            } catch (error) {
                tg.showAlert(`–î–ª—è –ø–æ–¥–∞—á–∏ –∂–∞–ª–æ–±—ã –Ω–∞–ø–∏—à–∏—Ç–µ @nukm0 –≤ Telegram —Å —Ç–µ–∫—Å—Ç–æ–º: "–•–æ—á—É –ø–æ–¥–∞—Ç—å –∂–∞–ª–æ–±—É!"`);
            }
        }
        
        // –ü—Ä–æ—Å–º–æ—Ç—Ä —Ñ–æ—Ç–æ
        function openPhotoViewer(adId, photoIndex = 0) {
            const allAds = getAllAds();
            const ad = allAds.find(a => a.id === adId);
            if (!ad || !ad.photoUrls || ad.photoUrls.length === 0) {
                showNotification('–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã', 'error');
                return;
            }
            
            appData.currentPhotoList = ad.photoUrls;
            appData.currentPhotoIndex = photoIndex;
            
            const modal = document.getElementById('photoModal');
            const modalImg = document.getElementById('modalPhoto');
            const counter = document.getElementById('photoCounter');
            
            modalImg.src = ad.photoUrls[photoIndex];
            counter.textContent = `${photoIndex + 1} / ${ad.photoUrls.length}`;
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closePhotoModal() {
            document.getElementById('photoModal').classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        function nextPhoto() {
            if (appData.currentPhotoList.length === 0) return;
            
            appData.currentPhotoIndex = (appData.currentPhotoIndex + 1) % appData.currentPhotoList.length;
            document.getElementById('modalPhoto').src = appData.currentPhotoList[appData.currentPhotoIndex];
            document.getElementById('photoCounter').textContent = 
                `${appData.currentPhotoIndex + 1} / ${appData.currentPhotoList.length}`;
        }
        
        function prevPhoto() {
            if (appData.currentPhotoList.length === 0) return;
            
            appData.currentPhotoIndex = appData.currentPhotoIndex === 0 
                ? appData.currentPhotoList.length - 1 
                : appData.currentPhotoIndex - 1;
            
            document.getElementById('modalPhoto').src = appData.currentPhotoList[appData.currentPhotoIndex];
            document.getElementById('photoCounter').textContent = 
                `${appData.currentPhotoIndex + 1} / ${appData.currentPhotoList.length}`;
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        function getCategoryName(category) {
            const categories = {
                'liquids': '–ñ–∏–¥–∫–æ—Å—Ç–∏',
                'disposable': '–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞',
                'pod': '–ü–æ–¥-—Å–∏—Å—Ç–µ–º—ã',
                'consumables': '–†–∞—Å—Ö–æ–¥–Ω–∏–∫–∏'
            };
            return categories[category] || category;
        }
        
        // ==================== –ó–ê–ü–£–°–ö –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø ====================
        
        document.addEventListener('DOMContentLoaded', function() {
            if (checkTelegram()) {
                initializeUser();
            }
        });
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        document.getElementById('photoModal').addEventListener('click', function(event) {
            if (event.target === this) {
                closePhotoModal();
            }
        });
    </script>
</body>
</html>
